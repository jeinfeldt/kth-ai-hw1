package kth.ai16.hw1.main;

import java.util.Arrays;

public class HMM5 {
	
	public static void main(String [] args){
		// observations
		int [] oSeq1 = new int[]{0,3,3,2,1,0,2,3,0,0,2,3,0,0,2,3,0,0,0,0,1,2,2,3,1,3,0,2,3,1,2,3,1,3,3,1,2,0,3,1,2,2,2,1,1,1,0,2,0,3,2,3,2,1,1,2,3,1,2,1,2,1,2,1,1,3,3,1,1,2,3,0,0,1,1,2,3,1,1,0,1,1,1,1,1,3,3,1,1,3,0,0,3,1,3,1,3,3,2,1,3,3,2,3,3,3,1,1,1,1,2,1,3,3,3,0,1,0,0,3,3,2,2,3,3,3,2,1,0,0,3,3,1,0,2,2,2,0,0,2,3,1,1,1,2,2,3,3,1,1,0,0,1,2,0,0,2,0,1,1,0,0,0,0,3,3,1,2,0,0,2,3,2,2,0,1,1,3,1,1,0,3,3,0,3,3,3,2,3,2,3,1,2,1,2,0,0,0,0,3,0,3,3,3,3,1,1,3,2,1,2,0,3,3,3,3,3,3,0,0,2,3,2,1,1,1,3,2,2,2,1,2,1,1,2,3,1,2,3,1,1,1,3,3,2,2,2,1,0,2,2,1,0,3,2,2,3,1,0,1,2,2,2,0,3,1,2,0,3,0,0,3,1,2,2,3,1,1,0,2,2,1,3,2,3,1,0,0,0,2,1,3,3,0,1,0,3,0,2,0,0,3,2,3,3,3,2,3,2,3,1,3,3,0,1,0,2,2,1,2,3,3,1,3,2,3,3,3,1,2,1,3,0,1,2,0,1,3,3,3,3,2,1,1,1,1,3,3,1,1,3,3,2,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,2,0,2,0,3,1,3,1,3,2,0,0,0,0,0,1,2,3,0,1,1,0,2,3,2,1,0,2,1,2,2,2,1,1,2,2,1,3,3,3,3,1,3,1,0,2,1,2,1,3,1,1,3,0,0,1,0,1,3,3,2,2,1,2,3,2,1,2,1,1,1,0,0,0,2,2,2,1,3,3,1,1,2,2,1,1,2,3,1,2,1,0,0,3,2,1,3,2,2,3,0,0,3,3,0,3,0,0,1,0,0,2,3,1,0,0,0,1,2,2,3,2,3,1,0,2,2,3,3,1,1,2,1,1,1,3,2,2,3,2,0,3,3,0,0,0,0,0,0,0,0,2,2,3,3,3,2,3,2,1,3,0,2,1,2,0,0,0,2,3,2,2,2,1,3,3,2,1,2,0,0,3,2,1,2,3,1,0,1,3,3,3,2,2,0,0,0,2,2,3,1,1,3,0,0,3,0,0,3,0,1,3,0,3,0,0,0,0,0,0,0,0,3,2,3,1,2,3,0,3,3,2,0,3,2,1,1,0,1,0,0,0,0,2,3,3,3,1,1,3,1,2,3,0,3,3,3,0,0,1,1,0,3,2,2,3,1,1,3,1,1,3,2,0,2,0,0,2,0,0,0,1,0,1,1,0,0,0,0,0,2,2,3,3,1,3,3,3,1,0,2,3,3,3,0,1,1,1,1,0,0,3,3,3,2,3,2,3,3,2,3,3,3,3,3,2,2,1,3,1,0,1,1,1,0,3,1,0,0,3,3,2,2,2,3,3,1,1,1,2,1,3,2,1,1,2,3,2,2,1,2,2,1,1,2,1,0,0,1,2,1,2,1,1,2,0,0,3,2,3,2,1,1,3,2,3,3,3,0,2,0,3,3,1,1,1,2,2,0,0,0,0,0,1,1,1,3,2,3,2,0,0,3,2,3,1,2,0,3,2,1,2,1,0,1,1,1,2,2,2,2,2,3,3,2,3,2,1,3,3,2,2,2,1,0,1,3,2,1,0,3,2,2,1,1,3,3,3,3,1,0,3,3,3,2,3,3,2,3,0,1,0,1,2,2,1,2,1,2,3,3,3,0,1,2,2,3,1,1,0,3,2,2,1,1,0,0,1,0,0,0,1,1,0,0,0,0,2,0,0,0,3,3,0,0,3,1,2,2,1,0,0,2,2,3,0,3,0,3,2,2,3,3,2,0,2,3,0,0,3,1,0,0,1,2,0,0,3,3,1,1,3,2,3,1,3,3,1,3,3,3,2,3,1,0,1,3,2,1,2,3,3,0,2,0,0,1,0,3,2,0,2,3,1,3,1,1,2,1,1,2,2,1,1,3,2,2,0,0,1,1,0,0,0,2,2,0,0,3,2,2,1,2,3,3,0,0,2,0,0,0,3,3,3,2,0,1,0,1,1,3};
		int [] oSeq2 = new int[]{2,2,3,0,1,2,3,1,2,1,3,2,0,2,1,0,3,2,1,0,1,0,0,0,1,0,3,3,2,1,0,0,0,0,0,0,2,0,0,2,3,2,3,0,0,0,1,3,1,0,2,1,0,0,3,1,3,1,0,0,2,0,0,0,0,0,1,0,0,0,0,3,3,2,3,1,2,2,2,1,3,2,0,3,3,2,1,2,1,0,1,3,1,1,1,1,2,1,1,2,2,1,0,0,0,3,0,3,3,0,0,0,0,1,3,3,1,3,3,1,2,1,3,3,3,3,2,2,0,0,1,1,3,3,3,0,2,0,0,1,1,0,0,1,0,2,0,1,0,3,2,3,0,1,0,2,2,3,3,1,3,3,1,0,2,1,0,3,0,1,1,0,2,2,3,2,3,1,3,3,3,3,0,3,3,2,2,1,3,3,1,3,2,2,2,1,1,2,2,1,0,0,1,3,3,3,2,3,0,0,0,0,1,1,0,0,0,2,3,3,3,1,1,0,0,1,1,1,0,0,3,2,3,0,0,0,0,2,1,0,0,0,3,3,1,1,0,3,3,1,3,3,2,2,0,1,1,0,1,1,1,3,3,2,3,3,3,3,1,1,1,1,1,3,3,1,1,2,3,0,0,0,0,0,0,3,3,0,3,2,3,3,2,3,3,3,2,3,3,0,0,1,0,1,3,2,0,0,0,1,0,3,1,3,2,0,1,3,1,3,2,3,2,3,1,3,3,2,0,1,3,2,2,3,0,2,0,0,0,2,0,0,0,3,0,1,0,1,1,1,0,1,1,0,0,0,1,0,3,3,3,2,3,3,1,0,1,0,1,0,1,1,2,3,1,3,3,0,3,1,2,2,3,3,3,2,1,2,2,0,0,0,2,3,3,2,2,1,3,3,2,2,1,1,3,3,3,3,3,1,1,1,2,1,2,2,1,0,0,3,3,1,1,1,2,2,3,3,0,2,3,0,0,1,1,1,1,1,2,2,2,2,1,3,0,1,3,2,0,1,3,1,1,1,1,2,0,0,1,0,0,1,2,1,1,1,3,1,0,2,1,0,2,0,0,0,0,0,1,1,0,0,2,1,1,0,1,1,0,3,1,3,1,1,0,1,0,3,1,2,2,2,0,2,3,0,0,1,2,0,3,3,2,1,1,2,0,0,0,0,2,3,1,2,2,2,0,0,1,1,1,1,3,3,1,2,1,1,0,3,3,3,0,0,1,1,1,1,0,1,1,1,3,1,1,1,3,2,2,2,1,3,0,1,3,3,3,3,2,2,1,1,2,2,2,2,0,1,0,1,1,3,1,3,2,3,3,2,3,3,2,0,1,2,2,3,2,3,1,2,1,1,1,0,2,1,3,2,0,3,1,3,3,1,1,1,1,1,3,1,1,0,0,3,3,0,0,0,0,0,2,3,2,3,1,1,3,1,2,3,1,2,0,3,3,3,2,3,2,0,1,0,1,3,3,3,1,2,0,2,3,3,1,1,2,1,1,2,0,1,0,3,2,2,1,2,1,1,0,1,2,3,2,3,2,3,2,1,2,1,1,1,3,3,2,0,3,1,2,0,0,0,1,1,1,0,2,2,3,3,1,3,0,1,3,0,1,2,3,3,0,1,1,1,0,3,2,2,3,1,3,2,3,0,0,0,1,3,3,1,2,0,3,2,3,0,2,3,1,1,0,0,1,1,3,2,1,2,1,2,2,1,1,3,3,1,2,2,1,3,2,0,0,0,1,3,1,3,1,1,2,3,3,2,0,0,0,0,0,3,2,2,2,2,3,1,2,3,3,0,0,1,0,2,0,1,2,1,1,1,0,2,2,0,0,0,3,1,0,0,1,1,0,3,1,2,3,1,1,2,2,1,3,1,3,1,0,1,2,3,2,1,3,1,2,2,0,1,0,2,1,0,0,0,1,1,1,0,1,2,1,1,3,1,1,3,2,3,2,2,1,1,1,3,1,1,2,3,2,1,2,3,3,2,3,3,3,3,2,0,0,2,2,2,1,3,3,0,3,1,1,1,0,0,1,1,1,2,2,2,3,3,3,2,1,2,1,0,0,2,3,3,1,1,0,2,1,0,2,1,0,0,3,1,2,2,3,3,1,2,2,1,1,0,0,0,3,2,1,2,3,2,0,0,2,0,0,2,2,2,3,3,2,0,0,0,2,1,2,1,1,2,0,3,3,3,2,1,1,1,2,3,1,3,3,1,1,3,3,1,2,3,3,0,1,1,2,3,1,0,1,3,1,3,2,0,0,1,0,0,2,0,0,3,2,3,0,1,3,0,3,3,1,0,2,1,2,1,3,2,1,2,2,2,3,3,2,0,0,0,1,0,0,0,3,1,1,2,0,2,3,2,2,2,3,3,3,0,3,0,0,0,0,0,3,1,3,2,2,1,2,0,2,0,0,0,2,2,3,3,0,2,3,2,3,3,3,0,0,0,2,0,0,0,0,0,1,0,0,0,3,1,3,2,2,0,2,3,3,3,1,1,1,1,1,2,1,0,3,3,1,3,2,0,3,0,0,0,3,2,2,3,1,2,3,3,3,0,1,0,0,0,0,0,2,2,1,1,0,1,0,1,3,3,1,0,0,3,1,3,0,2,3,3,3,2,2,1,0,0,3,3,0,0,3,2,3,1,3,1,2,0,1,3,3,2,2,3,1,2,2,1,0,0,1,2,3,1,2,2,3,0,3,3,2,0,1,0,0,1,3,1,2,1,2,3,1,0,0,3,2,0,2,2,1,3,1,2,1,2,2,1,2,1,3,3,3,3,2,2,1,0,3,3,3,0,2,1,0,3,1,0,1,1,3,0,0,0,0,1,0,0,2,0,0,0,1,0,1,3,0,2,2,3,3,3,0,1,3,1,2,1,1,2,2,2,3,2,0,0,2,0,0,0,2,0,0,1,1,3,2,0,0,0,0,0,0,0,3,2,3,1,0,2,0,2,3,2,0,0,0,1,3,3,0,1,0,1,1,0,2,0,3,2,0,1,2,1,2,3,2,0,3,1,1,1,0,3,1,1,2,0,0,0,0,0,0,0,3,3,1,1,3,1,0,2,1,3,0,3,0,0,1,1,1,1,2,0,3,2,2,3,3,1,0,2,2,3,2,0,2,1,0,0,0,2,3,1,1,2,1,3,3,1,1,1,3,2,1,1,1,1,3,3,0,3,3,3,1,2,1,1,0,3,3,3,3,1,1,2,3,3,3,1,1,1,1,2,1,0,2,2,1,1,0,0,0,0,2,0,0,0,0,0,2,0,0,1,3,2,2,1,2,0,1,0,0,2,1,2,3,1,3,3,1,1,1,2,1,0,1,0,3,1,3,1,1,1,0,3,1,0,2,1,2,0,1,3,3,2,1,2,1,3,0,2,0,0,3,2,1,1,1,0,0,2,0,0,0,0,0,1,0,3,1,1,0,1,1,1,0,0,0,1,1,3,2,2,3,3,1,2,1,0,3,3,3,1,1,2,0,2,3,3,3,3,2,3,2,1,0,1,3,3,3,0,0,0,0,0,0,0,0,2,3,3,1,0,1,3,1,3,3,1,3,1,3,3,1,1,0,2,2,1,2,3,2,0,0,2,0,1,1,1,1,3,3,2,2,1,1,1,1,1,1,0,3,3,2,3,1,2,2,3,2,3,3,1,1,0,1,3,2,0,1,2,3,1,2,2,2,1,2,1,3,2,1,2,2,1,1,2,2,1,3,1,0,1,1,0,3,1,3,3,2,3,1,1,0,2,0,3,2,0,2,1,3,1,0,2,2,3,2,3,2,3,3,3,3,3,1,0,0,3,3,3,1,1,0,0,0,1,0,0,1,0,2,0,0,2,1,3,2,3,1,1,3,2,0,1,1,1,3,2,2,3,3,3,0,3,3,1,3,1,2,3,2,3,0,3,1,1,1,0,1,1,3,1,2,0,0,2,1,3,3,3,1,2,2,1,3,1,1,1,1,1,2,0,0,0,0,0,1,0,1,3,0,2,2,0,1,2,0,0,1,0,2,2,0,1,2,3,3,2,1,3,0,3,0,3,3,3,1,3,1,3,2,2,1,0,0,1,0,1,3,2,0,1,0,3,3,2,1,3,1,2,3,3,0,1,1,3,1,1,3,0,3,3,1,3,1,0,2,3,3,3,1,3,0,1,2,0,0,0,0,2,2,2,2,2,1,2,1,0,2,0,1,1,2,0,1,1,1,0,0,3,3,3,1,3,0,2,2,3,2,1,0,2,0,0,0,2,3,1,1,3,2,1,2,3,2,0,1,2,1,1,1,0,1,3,2,1,1,1,0,0,1,0,0,0,1,0,0,3,0,2,2,1,0,0,1,3,0,0,0,1,0,3,0,0,0,0,1,3,1,1,0,1,3,1,0,2,1,2,1,0,0,1,1,1,2,1,3,3,3,0,2,0,0,1,2,0,0,0,0,0,1,3,0,0,2,2,2,2,2,0,1,0,3,1,0,0,1,2,1,1,1,3,3,0,1,0,0,0,0,0,2,2,1,3,3,3,1,1,1,0,0,0,3,3,3,2,0,1,3,2,3,3,1,1,1,3,2,3,2,0,1,1,2,0,1,2,2,1,0,1,1,3,2,1,2,1,2,1,2,3,2,3,3,3,3,3,1,1,2,3,1,1,1,0,0,3,3,2,0,3,3,3,2,3,3,3,0,3,1,2,1,1,0,0,1,1,3,3,1,1,1,1,3,2,3,2,0,0,3,1,0,0,2,0,1,3,2,1,0,2,2,3,2,2,3,3,3,3,0,0,0,3,3,3,2,2,1,2,1,2,0,0,1,0,3,3,3,3,2,2,2,3,3,0,1,1,2,0,0,3,0,0,2,0,0,0,3,3,3,1,3,3,1,2,1,0,0,0,1,3,1,1,1,2,2,2,1,3,1,0,0,1,2,0,2,2,3,1,1,1,1,3,0,3,1,0,3,1,2,3,3,3,0,3,1,0,1,1,1,2,3,1,0,3,2,3,1,3,1,3,2,1,1,1,1,2,1,1,0,0,0,0,0,0,3,0,1,0,0,0,0,3,3,0,3,2,1,3,1,3,2,2,0,0,1,1,2,1,0,0,1,3,0,0,0,0,0,2,2,2,0,1,2,2,3,3,0,2,0,3,2,1,1,1,3,3,3,3,2,2,1,0,0,1,3,1,3,0,1,2,1,1,3,1,0,1,0,0,2,3,0,3,2,0,0,1,0,0,0,1,0,2,1,1,1,3,2,2,1,3,2,1,1,2,3,0,2,2,3,2,1,2,0,0,2,1,1,1,2,1,0,3,1,1,3,2,3,1,3,3,1,0,1,1,0,1,1,0,3,3,2,3,2,0,0,1,0,0,0,0,0,0,1,0,2,1,1,2,2,3,0,2,1,3,1,0,1,0,2,0,0,2,2,2,0,1,0,3,2,2,1,3,1,0,0,0,3,1,2,0,3,3,3,1,0,0,0,0,3,3,3,3,0,0,1,0,0,3,3,3,3,0,0,1,1,3,1,2,3,1,1,3,2,1,3,2,3,1,0,0,2,1,2,0,0,0,1,1,2,3,0,0,3,0,3,1,3,3,2,3,0,0,3,2,3,0,0,0,2,0,1,2,1,0,0,2,2,0,1,3,3,3,3,2,3,2,2,3,1,0,3,1,2,1,3,3,1,3,1,2,0,2,0,0,1,1,1,2,0,3,0,1,3,1,0,0,0,0,0,3,1,3,0,3,0,2,3,0,1,1,0,3,0,2,2,3,1,0,0,0,3,0,1,3,3,0,3,1,3,1,3,3,0,3,3,3,3,1,2,1,0,1,3,1,2,3,1,1,1,1,0,2,0,0,0,1,3,1,2,1,3,1,3,2,3,3,3,3,3,1,2,2,3,3,2,0,0,0,0,0,0,0,1,0,0,0,0,0,2,2,0,0,0,3,0,3,2,0,0,3,1,1,1,1,3,3,3,3,3,0,0,1,0,0,0,0,0,2,3,1,0,2,3,3,1,1,1,1,0,2,1,0,3,1,2,2,1,2,1,2,2,1,3,2,3,2,3,1,3,3,3,1,0,3,1,1,0,1,1,1,0,0,1,2,2,3,0,2,1,1,1,0,0,1,2,3,3,3,1,3,1,2,0,0,0,0,0,1,0,3,0,0,2,0,0,1,3,1,0,1,0,0,0,3,3,1,3,3,1,0,0,0,0,0,1,1,0,0,0,0,0,0,2,0,0,0,3,2,2,0,3,2,1,2,2,1,1,3,0,3,1,2,1,0,1,2,3,3,2,1,0,1,0,1,3,3,0,0,1,0,0,0,3,3,2,2,1,3,2,2,0,1,0,3,2,3,1,0,1,3,2,2,0,2,2,1,2,1,3,0,3,0,0,1,3,3,3,3,1,2,2,2,1,1,0,0,0,0,3,3,3,1,2,0,1,2,3,1,2,3,0,1,2,2,3,3,2,3,2,1,0,0,0,0,0,0,3,1,1,0,1,0,0,0,1,1,3,0,2,2,2,2,2,1,2,1,1,3,1,1,1,3,3,0,2,1,0,1,0,1,1,3,2,3,1,1,3,2,2,1,2,1,3,2,1,0,3,2,1,2,1,1,3,2,3,3,1,1,2,1,0,1,1,3,2,0,0,1,3,0,1,1,3,3,3,3,1,0,0,3,3,2,1,0,1,2,2,3,3,0,0,0,0,0,0,0,0,0,3,0,1,3,0,0,2,2,0,0,0,0,0,3,3,3,3,2,2,1,2,1,1,0,2,3,1,0,0,1,2,2,1,3,1,2,3,2,3,2,2,3,2,0,1,2,1,3,2,3,3,2,3,1,1,2,2,2,1,3,2,1,3,2,0,3,1,2,1,3,2,3,3,2,3,2,1,1,1,0,0,0,0,0,2,2,1,3,2,3,3,1,0,0,0,1,0,0,2,0,1,3,2,0,1,1,0,0,2,0,1,2,1,0,0,0,0,0,0,3,1,1,1,3,2,1,2,3,2,3,3,3,2,0,1,0,2,2,2,2,1,2,3,3,3,3,3,2,1,3,1,1,0,3,2,3,1,1,0,2,3,2,0,3,1,1,1,2,0,1,1,0,3,3,1,1,0,0,3,1,0,3,1,0,0,0,0,0,0,0,0,0,0,0,3,3,3,2,3,3,3,3,1,3,3,2,2,3,1,2,0,1,3,0,0,0,0,1,0,1,1,3,2,0,2,2,0,0,0,1,0,0,0,3,0,0,0,3,2,3,2,1,3,2,0,3,2,1,2,2,1,0,1,2,0,0,3,3,3,1,3,3,3,3,1,1,1,0,3,3,1,1,0,1,0,0,0,0,0,1,3,3,0,1,3,3,1,0,0,3,3,3,3,1,1,1,2,1,1,0,1,3,1,0,0,0,3,3,2,3,3,0,2,1,1,1,2,2,3,1,2,2,1,3,3,0,3,3,3,3,2,3,0,2,1,1,1,0,0,2,0,0,1,0,1,1,0,0,3,2,1,2,3,1,3,1,0,1,1,0,3,2,0,2,2,0,0,0,0,2,1,2,3,2,1,1,3,0,0,0,3,0,1,2,1,3,2,1,3,0,3,3,1,0,3,1,1,1,1,1,2,0,2,1,3,1,1,1,3,2,2,3,3,0,3,3,1,3,1,1,1,1,2,1,2,0,3,1,2,0,3,2,1,3,3,0,2,3,0,3,3,0,1,2,3,1,0,1,3,0,1,2,2,2,1,2,2,1,3,3,3,3,2,3,3,1,0,0,0,3,2,1,1,2,2,0,3,2,2,2,2,0,0,0,2,3,2,0,3,2,0,2,2,2,0,1,2,1,1,1,1,0,0,0,0,0,0,1,0,0,3,3,1,0,3,3,0,0,0,0,0,3,0,2,1,1,1,2,2,0,0,0,0,1,0,2,2,3,3,0,3,2,2,2,1,3,2,1,3,1,2,2,2,2,1,1,1,3,3,1,3,2,0,0,2,3,1,0,0,1,0,0,0,2,1,0,2,1,0,2,0,0,0,3,0,1,2,3,3,1,0,0,0,0,2,0,0,3,0,0,2,1,3,3,1,0,2,2,1,0,0,0,0,3,3,1,3,1,1,2,2,3,2,1,1,3,2,2,3,0,0,3,0,0,0,0,3,1,2,2,2,3,2,0,0,1,3,1,1,0,0,0,3,3,2,3,1,3,3,3,3,0,0,1,1,0,2,1,0,2,1,1,3,3,2,0,3,3,0,0,3,0,1,0,0,2,2,2,2,2,1,0,0,0,0,0,2,3,1,3,3,1,3,3,3,3,3,3,3,3,3,2,3,3,0,3,2,3,2,1,1,1,1,1,2,3,3,1,2,3,3,1,1,2,1,3,3,1,3,2,1,2,0,2,1,0,1,3,3,3,1,1,0,0,3,3,0,0,3,2,2,1,3,0,0,2,2,3,2,1,1,3,3,1,1,3,0,2,1,1,1,2,2,0,0,0,0,0,0,3,0,3,2,2,2,1,2,2,3,2,1,2,2,0,0,0,1,0,0,0,0,1,1,0,0,0,1,2,1,2,0,3,1,1,1,0,0,2,1,2,2,0,0,0,1,1,2,2,2,1,1,2,1,1,1,1,0,0,3,3,2,2,1,2,0,3,1,2,2,1,2,1,1,2,1,2,1,2,2,3,1,3,1,3,0,2,1,2,3,0,3,2,1,2,1,2,1,1,0,0,1,1,3,1,0,2,0,1,0,3,3,3,3,3,2,1,0,3,0,0,0,1,1,3,3,1,3,3,1,3,2,2,0,3,1,1,3,0,0,2,3,1,1,2,3,1,0,2,1,1,1,3,2,1,2,2,1,2,1,3,2,1,3,0,1,3,1,0,1,2,1,0,0,1,2,3,2,3,2,3,3,3,3,1,1,2,1,2,0,1,3,2,2,1,0,0,1,1,0,1,2,0,0,0,1,1,3,2,1,0,1,0,0,2,3,2,3,2,1,2,2,0,2,1,1,2,1,1,2,1,2,2,2,0,2,0,0,0,1,2,2,1,0,1,1,3,1,1,1,3,3,0,1,2,1,0,0,0,2,0,0,3,3,3,1,2,3,3,3,2,1,1,0,1,1,1,0,3,3,0,3,1,2,1,3,2,3,1,1,2,0,2,0,0,0,2,0,2,3,2,0,1,3,0,0,3,0,3,2,1,0,3,3,3,2,3,2,3,1,1,1,1,3,0,0,0,3,2,2,0,0,2,3,3,2,1,2,3,3,3,3,2,3,1,1,2,1,1,3,0,1,0,1,2,0,1,0,3,3,1,2,1,1,2,3,1,2,1,0,0,0,0,0,3,1,1,3,1,1,3,1,0,0,2,0,0,2,1,2,3,1,3,1,1,1,2,2,2,2,2,1,3,3,2,1,3,3,2,3,1,1,1,1,1,1,3,3,3,2,3,1,1,2,3,2,3,3,2,3,2,1,1,1,3,0,1,2,3,0,1,3,3,3,2,3,3,0,1,2,1,2,1,3,3,3,3,3,3,0,2,0,1,2,3,1,3,1,1,2,0,0,3,1,3,2,1,2,2,3,1,3,1,0,3,2,3,1,3,0,2,0,1,1,2,0,0,2,3,2,1,3,1,3,1,1,1,1,3,3,0,0,0,0,2,3,3,2,0,0,3,1,0,0,1,1,1,2,2,3,0,2,3,1,1,1,3,2,2,1,2,1,1,2,3,1,3,3,1,3,1,2,2,1,1,1,2,1,1,3,2,1,3,0,0,1,1,1,3,3,0,0,2,2,1,0,0,0,0,1,0,0,2,0,0,0,3,1,0,3,1,1,0,0,0,0,3,3,3,1,1,3,1,1,3,1,2,1,1,2,3,2,2,1,0,0,1,3,0,0,0,0,0,3,1,1,1,2,1,2,2,1,2,2,1,3,0,2,3,3,2,2,3,2,1,3,1,0,0,1,0,1,3,2,2,0,1,1,3,3,3,1,2,1,3,0,2,1,0,0,2,2,2,0,0,3,3,3,3,1,2,3,1,1,1,1,2,1,1,3,0,2,2,3,3,3,0,1,3,2,1,2,0,1,2,0,0,3,3,1,0,2,1,1,2,0,1,0,1,3,1,0,0,3,3,2,1,2,0,3,2,1,1,3,1,1,0,0,0,1,1,3,3,0,2,1,0,2,3,1,1,3,1,1,3,1,2,3,3,1,1,3,3,3,1,1,3,3,2,3,2,2,0,2,2,2,3,2,3,1,0,0,1,2,3,1,2,0,3,3,1,1,3,3,2,2,2,2,1,1,1,1,2,2,1,1,0,1,1,0,1,1,0,1,1,0,3,3,3,2,0,1,1,2,3,3,1,3,1,2,3,3,3,3,0,3,3,3,3,2,0,0,0,1,1,0,0,2,3,3,3,2,1,3,2,2,1,2,2,1,0,0,2,3,1,3,2,3,2,1,3,3,0,2,2,0,0,2,3,0,0,2,3,3,0,1,2,0,3,1,1,1,2,3,1,3,1,2,0,1,1,0,2,3,0,2,1,1,1,3,0,1,1,0,1,1,3,1,3,3,1,3,2,0,2,2,0,0,0,1,2,1,2,1,1,2,1,1,1,3,3,3,3,3,2,1,0,3,2,3,3,3,2,0,1,2,1,3,3,3,3,3,0,0,0,0,0,1,0,3,2,0,0,3,3,2,2,1,1,3,3,3,3,3,3,3,0,3,3,3,2,3,3,1,1,3,1,3,1,1,1,3,1,1,1,2,0,0,0,2,2,1,3,0,0,1,0,3,0,0,1,2,2,1,1,2,1,2,1,1,3,3,2,2,3,1,1,3,1,3,3,3,1,3,1,0,3,3,3,1,3,2,0,3,1,0,1,3,3,0,1,0,1,1,2,1,3,1,2,2,2,2,2,2,2,1,1,2,2,3,3,0,2,1,0,1,1,2,1,1,0,1,0,0,0,0,0,1,3,0,1,0,1,0,2,1,3,1,0,1,0,3,0,1,1,3,0,2,0,0,0,3,3,3,3,0,3,1,1,0,0,1,2,0,0,0,0,2,0,2,0,2,0,0,0,0,1,1,3,1,2,3,3,2,3,0,0,1,3,1,3,3,1,0,1,3,3,3,3,0,3,1,1,1,0,1,3,1,0,0,0,1,0,0,1,3,1,3,3,1,2,2,1,0,0,1,1,0,1,3,3,2,1,3,3,3,0,0,3,1,0,0,0,0,1,2,3,3,3,2,2,2,1,1,3,2,1,1,1,2,0,0,0,0,0,2,1,0,2,1,0,1,3,1,1,3,3,3,3,1,3,1,2,2,0,2,2,3,0,1,2,2,0,2,3,3,1,0,3,1,1,1,3,3,0,3,2,3,3,0,3,1,0,0,0,0,1,0,2,2,0,2,1,2,0,0,0,3,2,3,1,3,1,3,0,3,1,0,3,3,3,1,1,2,0,0,0,0,3,1,3,1,0,2,2,3,0,2,2,3,2,1,1,1,1,1,1,2,0,0,3,1,3,1,0,0,0,0,0,0,2,0,0,1,0,0,1,2,0,0,0,1,3,3,3,3,2,2,1,2,3,3,1,0,0,0,0,1,1,0,3,3,3,3,2,0,0,0,0,0,0,1,0,0,0,3,1,3,1,2,1,1,1,2,2,1,2,3,3,2,1,3,1,1,3,2,0,0,2,2,3,3,2,3,3,3,3,0,2,3,1,1,1,0,3,3,3,3,1,1,2,1,1,2,1,1,1,2,1,1,1,3,3,2,0,0,3,3,0,0,3,2,1,0,2,0,2,0,3,0,0,3,1,3,3,3,2,3,1,3,3,3,3,2,3,2,1,1,0,0,0,0,2,2,1,3,1,3,0,3,3,3,3,3,1,0,0,0,1,2,2,1,3,0,1,3,3,1,1,3,2,1,1,2,0,1,1,2,0,1,3,0,3,2,1,1,1,1,3,3,2,2,1,2,0,0,3,3,3,3,1,0,1,2,1,1,2,0,1,1,0,1,0,1,0,0,3,0,2,1,2,0,3,1,0,0,1,2,2,2,3,0,2,0,0,2,0,1,0,1,0,0,3,3,1,3,2,3,1,2,0,3,3,2,2,2,3,1,3,3,3,3,1,2,3,1,3,3,1,0,0,2,2,2,3,2,2,1,2,1,0,3,3,1,1,3,1,3,2,2,1,1,1,2,1,1,1,3,2,1,0,0,0,2,2,2,3,3,3,3,1,1,1,1,0,0,2,3,3,3,3,1,2,0,1,1,3,1,3,3,1,1,1,1,1,3,0,0,1,0,3,2,3,3,3,0,2,2,0,0,3,0,1,0,0,2,2,0,3,2,2,1,1,3,2,3,1,3,3,1,1,0,0,1,1,1,3,3,3,0,0,0,0,0,1,3,2,3,1,1,2,3,1,3,3,2,1,2,1,1,1,3,3,2,1,1,3,0,2,3,1,2,1,3,1,1,0,0,2,1,1,0,0,1,0,0,0,3,2,0,0,2,2,0,1,0,0,0,0,0,0,0,3,3,3,3,2,1,2,1,1,3,2,2,3,2,2,2,2,3,1,2,2,1,2,2,1,1,1,1,2,2,3,3,2,0,0,2,1,0,1,3,1,2,3,3,3,3,2,1,1,3,1,0,3,0,0,3,3,1,1,3,3,1,3,3,3,2,3,1,3,3,1,1,1,1,2,1,3,3,1,2,3,3,1,2,2,1,1,2,1,1,3,3,3,1,1,3,0,0,3,1,3,3,3,3,1,0,0,3,2,2,2,1,0,0,3,1,0,2,3,3,1,0,1,3,3,2,3,1,2,0,1,0,1,0,0,3,0,3,0,2,3,0,0,2,2,1,0,1,3,1,3,3,1,3,1,1,2,2,3,2,3,3,0,2,0,3,0,0,0,2,2,0,0,0,1,0,0,1,3,2,3,3,2,0,0,0,0,3,3,0,0,0,0,0,1,0,3,0,1,0,0,0,0,3,2,0,3,3,3,3,1,3,1,2,3,1,1,0,2,0,3,2,2,1,1,1,3,1,3,0,3,2,1,1,1,1,2,1,0,0,0,1,1,0,0,0,0,1,0,2,0,0,0,2,3,0,2,3,2,1,2,1,1,0,1,0,0,2,0,0,3,1,2,2,2,0,0,2,0,0,3,3,0,0,0,0,3,1,1,2,3,3,1,3,0,3,1,1,0,3,3,3,3,3,2,2,1,0,0,0,0,0,0,0,0,0,0,1,3,1,3,3,1,2,2,2,2,0,0,1,2,3,3,2,3,2,2,2,3,2,0,1,1,1,0,0,0,0,0,0,0,3,0,0,0,3,1,3,3,3,0,0,0,1,3,1,2,1,1,1,1,1,0,3,0,1,0,0,1,0,0,3,1,3,2,0,3,0,1,1,0,0,3,1,1,1,3,2,1,3,2,3,1,2,3,0,3,3,3,1,2,3,3,0,0,0,2,0,0,0,2,3,2,1,1,3,1,0,0,0,1,0,0,1,3,1,0,1,0,0,0,0,3,2,1,3,0,1,0,1,0,0,1,2,1,2,2,1,3,0,0,0,3,0,2,1,3,0,0,2,2,3,1,3,0,3,1,0,0,1,2,1,1,2,2,1,1,1,1,2,0,2,1,2,2,1,0,1,1,1,3,0,0,2,0,3,0,1,0,0,0,2,2,3,2,3,2,2,3,1,1,0,1,3,3,1,1,1,2,1,2,3,0,0,3,3,1,1,3,2,1,3,1,3,3,1,3,2,0,0,0,2,3,1,2,0,2,1,1,1,1,0,1,3,3,3,3,0,0,0,3,3,3,3,0,3,2,1,2,3,1,2,3,1,1,1,2,1,1,3,0,0,1,1,0,0,0,2,3,3,2,1,1,2,1,2,1,2,2,1,1,3,0,1,3,2,3,0,1,0,3,3,0,3,3,1,1,3,3,3,2,1,2,1,0,2,3,3,1,2,2,2,0,1,0,1,3,1,2,3,3,2,0,3,1,2,3,2,0,3,3,2,1,3,1,1,3,0,2,0,0,0,3,2,0,0,0,0,0,0,0,1,1,2,2,3,2,2,2,2,3,3,1,1,3,3,0,3,0,0,0,0,0,0,0,0,1,3,1,0,0,0,0,3,2,3,3,1,0,3,3,1,2,2,3,0,1,0,0,3,1,2,0,0,0,3,1,3,1,3,2,2,1,2,3,2,3,1,0,0,1,3,3,2,1,2,0,0,0,0,2,1,1,1,0,0,3,3,2,0,1,2,2,3,2,1,2,2,3,1,1,3,1,3,1,0,0,2,0,3,2,1,1,3,0,2,2,1,1,3,2,3,0,0,0,0,0,0,0,0,2,2,0,0,3,1,3,1,3,3,3,3,3,2,3,3,0,0,0,0,1,2,1,0,0,0,0,2,2,0,0,0,3,3,1,3,3,3,2,1,1,1,2,3,0,0,3,1,3,0,3,2,1,0,1,1,1,0,2,3,1,2,3,3,2,2,3,3,0,0,1,1,3,3,3,3,0,3,0,0,0,0,3,2,3,2,1,0,2,2,1,0,2,2,0,1,1,1,1,2,1,1,2,2,2,2,0,1,0,0,0,1,3,2,2,1,3,0,3,3,3,1,1,1,2,2,1,0,3,3,3,1,1,3,1,0,0,1,2,3,3,0,2,0,0,0,2,2,2,1,2,1,0,1,1,2,0,0,1,0,0,3,3,1,1,3,3,1,1,0,0,0,0,0,0,1,3,3,0,3,2,0,1,3,0,1,3,3,3,3,0,0,0,3,0,3,2,3,3,2,0,1,1,0,0,0,3,1,3,0,1,3,3,1,1,1,1,0,1,0,1,3,3,1,2,1,1,1,1,3,3,2,3,2,2,2,2,3,3,1,1,0,0,0,0,1,2,1,0,1,0,0,1,0,0,0,1,0,0,2,2,0,3,3,2,1,2,3,3,3,0,2,3,3,2,2,0,0,1,2,1,1,0,3,1,1,1,3,1,1,3,2,1,3,3,0,2,0,2,2,1,1,1,3,3,3,3,3,3,0,3,2,0,1,2,3,0,0,1,1,2,0,0,0,3,1,3,3,1,2,2,2,0,0,3,2,0,0,0,2,0,2,1,3,2,2,0,1,0,2,1,3,0,2,1,2,3,2,1,1,1,2,1,0,3,3,3,3,2,0,1,3,3,3,3,2,1,1,1,1,2,1,3,1,3,1,3,2,1,3,3,1,3,1,0,0,3,3,2,3,3,1,3,2,1,3,3,2,3,3,0,1,1,1,1,0,1,1,1,2,1,3,2,3,2,3,3,2,3,2,2,3,0,0,1,2,0,1,0,2,0,3,0,2,2,1,3,2,2,2,0,1,2,1,3,1,3,3,2,2,2,0,0,0,0,0,3,3,3,3,3,0,0,0,1,1,1,0,2,3,0,0,2,1,3,2,3,1,1,0,0,2,0,0,3,2,3,3,2,3,1,1,2,1,0,3,2,2,1,1,3,2,0,2,1,3,1,0,0,2,1,2,3,0,3,2,1,3,0,0,2,2,1,2,0,2,0,1,1,0,3,0,1,2,1,1,2,3,1,0,0,0,1,1,1,3,2,3,1,0,0,0,0,2,3,3,3,0,2,3,2,2,1,0,3,0,3,2,2,0,3,0,0,0,0,2,3,2,1,1,1,0,0,3,2,3,2,3,2,2,2,3,3,2,3,1,1,1,3,0,2,1,1,0,0,1,3,1,1,0,3,3,1,0,1,0,2,3,1,0,0,2,0,0,0,1,3,3,2,0,0,2,3,3,0,3,0,2,2,0,0,3,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,3,3,1,1,2,3,0,0,0,0,0,0,1,1,1,1,0,0,2,0,3,1,3,1,2,2,1,0,2,1,3,0,0,1,1,1,3,1,2,2,3,2,2,3,2,1,3,3,0,0,0,2,2,3,1,2,1,3,3,1,1,3,2,3,1,1,2,3,1,2,1,3,0,0,1,3,3,2,3,0,3,3,1,2,1,2,1,1,2,1,0,0,0,0,0,0,0,0,0,0,0,2,0,2,3,3,1,0,3,2,1,2,1,1,1,3,0,0,0,1,1,2,1,2,3,3,3,3,1,1,0,2,1,3,1,1,1,0,1,1,1,1,2,2,1,0,3,3,3,3,2,2,1,1,0,0,0,1,0,0,0,1,2,0,1,0,2,2,3,0,1,3,3,1,0,0,1,1,3,2,2,2,1,3,2,3,3,1,0,0,0,1,0,0,3,2,0,0,2,3,2,3,1,2,0,0,2,1,0,1,0,0,3,1,3,0,1,0,0,3,0,2,2,1,3,1,3,2,1,1,1,1,1,2,1,3,2,0,3,1,2,1,2,2,2,1,2,2,2,1,2,3,3,2,2,3,2,1,2,3,1,1,1,1,3,3,1,1,3,2,0,0,3,3,1,3,2,2,0,2,0,0,0,1,0,3,3,3,3,2,3,2,1,2,1,2,1,2,3,2,2,3,2,1,1,2,1,2,2,3,2,1,0,3,3,2,2,1,1,1,0,0,0,2,2,1,3,1,0,0,3,3,2,1,2,2,0,3,1,3,3,0,2,0,0,1,0,3,3,3,1,3,1,3,1,2,0,2,1,0,0,1,3,1,3,0,2,3,3,2,2,3,0,0,0,0,1,3,2,0,2,1,0,1,1,2,3,3,2,2,3,1,1,3,2,1,1,1,2,3,3,2,2,2,3,3,1,0,1,2,2,1,2,0,0,0,3,0,3,1,2,2,0,3,0,1,1,2,1,0,2,1,1,2,2,0,1,0,1,0,0,2,0,0,1,1,3,3,0,1,1,2,3,3,3,0,0,0,1,1,1,0,0,0,0,3,3,1,1,1,1,3,0,3,3,0,1,1,3,0,2,0,0,0,0,0,0,1,1,0,0,0,3,2,2,3,3,2,3,0,0,3,3,0,2,1,1,1,0,0,1,0,0,2,0,0,3,0,0,0,0,2,3,3,2,3,2,3,2,0,1,0,2,0,1,3,3,3,2,0,2,1,1,1,2,3,2,0,0,1,0,2,2,0,0,3,1,3,3,2,3,3,1,0,1,0,1,2,1,3,3,3,3,2,0,2,0,0,3,2,3,3,3,0,2,1,0,0,0,3,1,0,1,3,0,0,0,0,0,1,1,0,2,3,1,2,3,2,1,0,1,2,0,0,0,3,1,2,1,1,3,1,3,0,1,2,3,2,1,0,2,2,2,0,1,2,3,0,0,0,0,2,0,0,0,3,1,2,3,3,3,1,0,3,3,0,2,2,0,2,2,1,3,1,1,2,2,0,0,1,2,0,1,2,0,0,2,0,0,0,3,3,1,3,3,2,1,3,2,2,2,2,3,2,1,2,2,0,0,1,0,0,0,3,3,2,1,2,0,2,2,2,3,2,3,1,1,2,1,2,0,1,1,2,0,0,2,3,3,0,0,0,0,0,0,0,0,0,0,1,0,0,3,2,2,3,1,1,1,0,2,1,2,3,1,2,1,0,0,2,2,0,0,0,0,3,0,0,0,2,0,0,0,1,1,1,1,2,3,3,1,1,1,1,2,2,3,3,2,2,0,3,2,1,2,3,1,0,2,0,1,1,2,0,0,2,3,1,3,1,0,2,3,3,0,0,0,3,3,1,3,0,0,1,2,2,0,3,3,3,3,0,0,3,2,1,1,0,0,0,0,2,3,0,3,1,1,0,0,2,2,2,0,0,3,3,3,3,3,0,3,3,0,0,2,0,1,3,3,3,0,0,0,2,3,0,0,1,0,0,0,3,3,0,0,3,2,1,3,2,3,2,0,3,2,3,0,2,1,3,3,2,3,2,2,1,0,1,3,2,3,0,2,2,0,0,3,1,2,0,2,0,0,0,1,3,3,2,1,0,1,2,1,1,3,3,3,3,3,1,0,3,2,2,1,1,2,3,1,3,1,2,0,0,1,3,2,0,2,3,1,3,2,1,2,2,0,0,0,3,0,2,1,2,1,2,0,1,0,0,0,1,2,0,0,0,2,2,3,3,2,0,0,2,1,0,0,1,1,3,2,1,1,2,3,3,3,0,2,1,0,2,0,0,2,2,3,0,0,1,3,2,0,0,3,1,1,2,3,0,2,1,2,0,0,3,3,3,3,0,1,0,2,3,2,2,0,1,0,1,1,3,3,3,0,0,0,3,3,1,2,1,1,1,2,2,2,0,1,0,0,1,0,0,0,1,3,3,3,1,0,0,3,3,2,3,0,3,3,3,0,1,1,3,1,1,0,1,2,3,1,0,1,1,3,2,1,2,0,1,3,0,0,0,2,3,3,3,3,3,3,3,3,3,1,0,1,0,0,3,1,2,2,3,2,0,3,3,3,1,2,2,3,3,3,2,3,3,3,1,2,2,1,1,1,2,2,2,3,0,1,2,3,1,3,1,1,0,1,2,3,0,0,0,0,0,2,2,1,1,1,3,1,2,2,2,2,2,2,1,1,1,1,1,1,3,1,1,1,3,0,0,0,1,1,3,0,1,1,0,0,0,3,3,1,0,0,3,3,3,3,1,3,2,1,1,2,0,1,2,1,1,2,1,3,2,1,3,3,1,0,2,2,3,1,3,3,3,0,3,1,3,1,0,0,0,0,0,0,3,0,1,3,3,1,2,1,3,2,2,2,1,1,2,2,0,3,3,1,2,3,1,1,2,2,1,1,0,1,3,2,3,3,3,1,2,3,1,1,2,2,1,0,1,2,1,2,3,3,2,3,2,2,2,2,3,3,2,1,2,0,2,0,0,0,3,1,1,1,3,3,3,1,1,2,3,3,1,0,3,1,3,1,3,1,1,2,2,1,1,0,1,1,0,2,0,0,0,3,3,3,0,0,1,3,3,2,0,1,3,0,1,2,0,0,3,3,2,2,3,3,2,3,3,1,1,1,2,2,1,0,3,3,2,1,1,3,3,3,3,0,0,3,2,0,0,0,0,1,0,3,1,1,3,0,3,0,3,2,3,3,0,2,0,0,3,1,3,0,0,3,3,2,3,1,1,2,3,1,0,0,3,2,1,1,1,1,2,3,1,0,0,0,0,0,1,0,0,1,3,1,1,2,2,3,2,2,1,1,1,2,2,2,1,0,2,1,1,3,1,1,2,1,3,3,3,1,1,3,1,3,1,2,2,2,3,1,3,1,1,2,2,2,2,3,3,2,3,2,0,0,2,1,1,1,1,1,1,3,0,0,3,1,2,3,1,0,2,1,2,3,0,3,1,0,1,0,0,1,2,3,1,0,3,2,1,3,3,1,0,1,3,1,3,1,0,0,3,2,1,1,2,0,0,1,0,0,0,2,1,2,3,3,3,1,0,1,3,3,3,1,0,3,3,1,2,1,1,0,2,3,1,2,3,1,2,0,0,0,1,0,2,3,3,3,3,1,0,1,0,3,2,1,0,0,3,1,3,2,0,1,0,0,0,1,0,0,1,1,1,2,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,2,3,1,1,3,0,0,1,1,2,1,3,0,0,0,0,0,2,2,1,0,3,0,3,1,0,2,0,2,1,2,1,0,2,2,3,2,0,0,0,1,2,2,1,0,0,2,2,0,1,0,0,3,2,2,2,1,1,2,3,3,1,1,2,3,1,3,1,0,0,0,0,0,3,3,3,3,3,3,3,3,3,0,0,0,1,0,0,2,3,1,1,0,3,1,0,0,1,1,3,3,0,2,0,0,0,1,0,0,2,3,3,2,2,0,2,0,0,1,3,1,3,1,0,3,3,1,3,1,3,3,1,1,2,0,3,1,1,2,2,2,3,3,3,2,0,0,0,3,1,0,1,1,1,1,2,3,3,1,3,2,2,3,0,2,1,3,3,3,2,3,0,1,2,1,3,1,3,0,2,2,1,2,1,0,1,3,2,0,1,1,3,1,3,2,3,3,3,1,3,1,0,2,1,1,3,1,2,2,0,3,3,3,3,1,3,3,0,1,0,0,3,3,3,0,1,1,0,0,3,2,1,1,0,2,2,3,0,2,2,2,2,0,0,0,0,3,3,3,1,0,0,1,0,1,0,0,2,3,0,2,0,3,3,2,3,0,1,0,2,1,1,3,2,2,1,1,0,1,0,0,0,0,2,0,3,0,1,3,1,2,2,1,3,3,3,2,0,2,3,1,2,0,1,1,2,0,0,0,0,0,0,0,3,3,0,2,2,1,0,0,3,3,3,1,3,1,1,0,2,1,3,2,3,3,1,1,1,2,3,2,3,3,0,0,0,3,0,0,1,0,0,2,3,3,3,0,2,1,1,2,2,3,3,1,3,0,3,3,3,1,3,0,1,2,1,0,0,0,3,3,3,1,3,3,3,1,0,2,1,2,0,0,3,2,0,1,0,3,0,1,0,0,1,0,0,3,3,1,1,2,1,1,1,3,3,1,2,1,2,2,0,0,0,2,3,3,0,2,1,3,2,2,3,3,3,1,3,1,3,1,2,3,3,3,2,1,3,1,0,3,3,3,1,1,3,2,2,2,2,1,1,1,2,0,0,3,3,3,1,0,0,0,0,0,1,0,0,1,1,3,1,2,3,1,3,3,1,3,1,1,2,3,3,0,2,2,1,1,1,1,1,2,2,2,1,1,0,0,0,0,2,0,3,2,1,2,1,3,3,3,1,2,3,1,0,0,3,3,3,3,3,3,0,0,2,0,1,1,0,0,1,3,3,3,1,0,1,0,0,2,3,0,2,2,0,0,3,3,2,2,1,1,1,2,2,2,2,1,0,0,0,3,1,1,1,3,2,1,2,0,3,1,1,2,1,2,1,2,1,1,2,0,1,1,0,0,3,1,3,3,2,1,3,3,3,0,0,3,1,1,1,0,0,2,1,0,0,3,0,0,0,1,2,0,0,1,2,3,3,0,1,0,0,0,1,2,1,1,3,0,2,2,2,1,3,3,3,2,3,2,2,0,3,2,3,1,0,0,0,2,3,3,3,3,2,1,3,0,0,2,2,3,3,2,1,3,2,1,3,2,3,3,2,0,1,1,1,2,2,3,2,3,3,2,1,1,3,0,2,0,0,3,3,3,1,0,1,2,3,2,1,2,2,2,2,3,1,1,0,0,3,3,3,2,1,0,0,1,0,0,0,0,1,2,1,2,1,3,0,0,0,0,2,1,3,2,2,1,1,0,3,0,2,2,1,1,2,1,3,3,2,3,2,2,0,0,1,0,2,1,3,2,1,3,2,0,0,3,3,3,1,2,3,3,0,1,1,0,1,0,1,3,0,2,2,1,1,0,0,0,1,0,1,1,3,3,1,1,1,1,2,2,2,3,3,3,3,3,0,1,3,2,1,1,1,2,2,0,2,0,0,0,3,3,3,3,3,2,3,0,1,1,2,2,3,0,3,2,3,0,3,1,2,1,2,3,1,3,3,2,2,3,1,1,1,2,3,1,0,0,0,1,1,1,2,2,1,1,0,0,3,1,2,2,1,3,2,3,3,3,3,3,3,3,3,3,1,0,3,3,0,0,3,0,1,0,0,0,1,0,0,3,3,2,1,1,0,2,2,3,2,0,3,3,2,1,3,0,0,1,0,2,0,2,0,1,3,0,0,3,3,1,2,2,3,2,0,0,1,0,1,1,1,1,2,0,0,2,3,2,1,3,3,1,1,1,2,1,1,0,0,2,1,2,1,0,0,0,1,1,3,2,3,0,1,3,1,1,3,0,2,0,2,3,3,2,1,1,1,0,1,0,2,3,1,0,0,2,3,2,0,3,1,3,2,1,2,1,3,2,2,1,1,3,1,2,0,0,0,0,3,3,3,3,3,2,0,1,1,1,2,2,1,1,0,2,2,3,1,2,1,2,3,3,0,0,2,1,1,2,1,3,1,3,3,3,0,0,3,1,3,3,0,0,2,3,3,2,3,1,1,2,1,1,2,1,3,2,3,0,3,2,2,2,2,1,1,3,1,1,3,3,3,2,2,1,3,1,0,0,0,3,3,0,1,1,3,3,3,1,3,3,1,3,0,0,0,0,0,0,2,3,1,3,3,3,0,3,3,0,1,3,1,1,0,3,3,1,0,2,3,1,1,3,0,3,0,0,0,1,2,3,2,1,3,1,3,1,1,3,2,0,1,1,1,2,2,1,3,0,3,1,1,1,0,1,3,3,3,1,2,1,1,0,3,3,1,0,3,3,1,1,1,3,1,3,3,2,2,0,3,2,0,2,1,3,0,3,1,2,3,2,2,2,1,3,2,0,0,3,0,0,0,2,2,3,1,1,1,2,0,3,2,1,3,3,3,2,2,2,1,1,2,0,0,2,3,3,1,0,3,0,1,0,2,0,0,0,2,0,0,0,0,0,2,2,2,1,0,1,3,0,3,1,0,3,2,0,2,1,3,0,3,0,3,2,2,2,0,2,2,3,1,3,3,0,0,3,3,2,3};
		
		// QUESTION 7
		q7output(oSeq1);
		// QUESTION 8
		q8output(oSeq1);
		// QUESTION 9
		q9output(oSeq2);
		// QUESTION 10
		q10output(oSeq1);
	}
	
	private static void q7output(int [] oSeq){
		// expected values
		double [] aExpected = new double[]{0.7, 0.05, 0.25, 0.1, 0.8, 0.1, 0.2, 0.3, 0.5};
		double [] bExpected = new double[]{0.7, 0.2, 0.1, 0, 0.1, 0.4, 0.3, 0.2, 0, 0.1, 0.2, 0.7};
		double [] piExpected = new double[]{1, 0, 0};
		
		// given values
		Matrix a = new Matrix(3, 3, new double[]{0.54, 0.26, 0.2, 0.19, 0.53, 0.28, 0.22, 0.18, 0.6});
		Matrix b = new Matrix(3, 4, new double[]{0.5, 0.2, 0.11, 0.19, 0.22, 0.28, 0.23, 0.27, 0.19, 0.21, 0.15, 0.45});
		Matrix pi = new Matrix(1, 3, new double[]{0.3, 0.2 ,0.5});
		
		// computation
		double epsilon = 0.8; // here for matrix comparison!
		boolean aConverged = false;
		boolean bConverged = false;
		boolean piConverged = false;
		int observations = 0;
		HMM myHmm = null;
		for(int i=1; i<oSeq.length; i += 1){
			myHmm = new HMM(pi.clone(), a.clone(), b.clone());
			myHmm.train(Arrays.copyOf(oSeq, i), 200, 0.0001, Double.NEGATIVE_INFINITY);
			double [] resultA = myHmm.getTransition().toArray();
			double [] resultB = myHmm.getEmission().toArray();
			double [] resultPi = myHmm.getInitial().toArray(); 
			if(!aConverged && compare(aExpected, resultA, epsilon)){
				System.out.println("A converged");
				aConverged = true;
			}
			if(!bConverged && compare(bExpected, resultB, epsilon)){
				System.out.println("B converged");
				bConverged = true;
			}
			if(!piConverged && compare(piExpected, resultPi, epsilon)){
				System.out.println("Pi converged");
				piConverged = true;
			}
			if(aConverged && bConverged && piConverged){
				break;
			}
			observations = i;
		}
		
		// output
		if(aConverged && bConverged && piConverged){
			System.out.println("Converged (epsilon=" +epsilon+")"+  " with observations: " + observations);
			System.out.println("Transition");
			System.out.println(myHmm.getTransition().show());
			System.out.println("Emission");
			System.out.println(myHmm.getEmission().show());
			System.out.println("Initial");
			System.out.println(myHmm.getInitial().show());
		} else {
			System.out.println("Did not converge");
		}
	}
	
	private static void q8output(int [] oSeq){
		Matrix pi = new Matrix(1,3, new double[]{0.5, 0.2, 0.2});
		Matrix a = new Matrix(3,3, new double[]{0.54, 0.26, 0.2, 0.19, 0.53, 0.28, 0.22, 0.18, 0.6});
		Matrix b = new Matrix(3,4, new double[]{0.45, 0.15, 0.21, 0.19, 0.27, 0.23, 0.28, 0.22, 0.19, 0.11, 0.2, 0.5});
		HMM myHmm = new HMM(pi, a, b);
		myHmm.train(oSeq, 200, 0.0001, Double.NEGATIVE_INFINITY);
		System.out.println("Transition");
		System.out.println(myHmm.getTransition().show());
		System.out.println("Emission");
		System.out.println(myHmm.getEmission().show());
		System.out.println("Initial pi");
		System.out.println(myHmm.getInitial().show());
		
	}
	
	private static void q9output(int [] oSeq){
		//Matrix a2 = new Matrix(2, 2, new double[]{0.64, 0.36, 0.2, 0.8});
		Matrix a2 = new Matrix(2, 2, new double[]{0.5, 0.5, 0.5, 0.5});
		Matrix b2 = new Matrix(2, 4, new double[]{0.5, 0.2, 0.11, 0.19, 0.22, 0.28, 0.23, 0.27});
		//Matrix b2 = new Matrix(2, 4, new double[]{0.25, 0.25 ,0.25, 0.25, 0.25, 0.25, 0.25, 0.25});
		Matrix pi2 = new Matrix(1, 2, new double[]{0.6, 0.4});
		
		Matrix a3 = new Matrix(4, 4, new double[]{0.24, 0.20, 0.3, 0.26, 0.1, 0.5, 0.21, 0.19, 0.23, 0.36, 0.19, 0.22, 0.3, 0.17, 0.31, 0.22});
		//Matrix a3 = new Matrix(4, 4, new double[]{0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25});
		//Matrix b3 = new Matrix(4, 4, new double[]{0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25});
		Matrix b3 = new Matrix(4, 4, new double[]{0.1, 0.3, 0.4, 0.2, 0.4, 0.12, 0.32, 0.16, 0.2, 0.6, 0.1, 0.1, 0.19, 0.28, 0.31, 0.22});
		Matrix pi3 = new Matrix(1, 4, new double[]{0.3, 0.2 ,0.35, 0.15});
		
		HMM myHmm = new HMM(pi3, a3, b3);
		myHmm.train(oSeq, 500, 0.0001, Double.NEGATIVE_INFINITY);
		System.out.println("Converged (epsilon=" +0.0001 + ")");
		System.out.println("Transition");
		System.out.println(myHmm.getTransition().show());
		System.out.println("Emission");
		System.out.println(myHmm.getEmission().show());
		System.out.println("Initial");
		System.out.println(myHmm.getInitial().show());
	}
	
	private static void q10output(int [] oSeq){
		Matrix aUni = new Matrix(3, 3, new double[]{1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0, 1.0/3.0});
		Matrix bUni = new Matrix(3, 4, new double[]{0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25, 0.25});
		Matrix piUni = new Matrix(1, 3, new double[]{1.0/3.0, 1.0/3.0, 1.0/3.0});
		
		Matrix aDia = new Matrix(3, 3, new double[]{1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0});
		Matrix piDia = new Matrix(1, 3, new double[]{0.0, 0.0, 1.0});
		
		Matrix aClose= new Matrix(3, 3, new double[]{0.68, 0.06, 0.26, 0.13, 0.76, 0.11, 0.15, 0.27, 0.58});
		Matrix bClose = new Matrix(3, 4, new double[]{0.7, 0.2, 0.1, 0, 0.1, 0.4, 0.3, 0.2, 0, 0.1, 0.2, 0.7});
		Matrix piClose = new Matrix(1, 3, new double[]{0.9, 0.05, 0.05});
	}

	private static boolean compare(double [] expectation, double [] result, double epsilon){
		for(int i=0; i<expectation.length; i++){
			double current = Math.abs(expectation[i] - result[i]);
			if(current > epsilon){
				return false;
			}
		}
		return true;
	}
}
